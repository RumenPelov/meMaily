(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{105:function(e,t,n){e.exports=n(181)},108:function(e,t,n){},181:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"fetchUser",function(){return C}),n.d(a,"logout",function(){return D}),n.d(a,"handleToken",function(){return F}),n.d(a,"submitSurvey",function(){return I}),n.d(a,"fetchSurveys",function(){return A}),n.d(a,"sortDescSurveys",function(){return V}),n.d(a,"sortAscSurveys",function(){return L}),n.d(a,"sortYesSurveys",function(){return Y}),n.d(a,"deleteSurvey",function(){return R}),n.d(a,"fetchDraft",function(){return T}),n.d(a,"clearDraft",function(){return W});n(106),n(108);var r=n(0),c=n.n(r),s=n(76),o=n.n(s),u=n(7),i=n(9),l=n(97),m=n.n(l),p=n(11),d=n(12),f=n(14),v=n(13),h=n(15),y=n(17),b=(n(58),n(121),n(44)),E=n(102),g=n.n(E),j=n(16),O=n.n(j),N=n(24),k=n(28),_=n.n(k),w="fetch_draft",x="init_draft",S=function(e){var t=e.slice(0,16).split("").filter(function(e){return"-"!==e&&"T"!==e&&":"!==e}).join("");return parseInt(t,10)},C=function(e){return function(){var t=Object(N.a)(O.a.mark(function t(n){var a;return O.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.a.get("/api/current_user");case 2:(a=t.sent).data._id||e.push("/"),n({type:"fetch_user",payload:a.data});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},D=function(e){return function(){var t=Object(N.a)(O.a.mark(function t(n){var a;return O.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.a.get("/api/logout");case 2:a=t.sent,e.push("/"),n({type:"fetch_user",payload:a.data});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},F=function(e){return function(){var t=Object(N.a)(O.a.mark(function t(n){var a;return O.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.a.post("/api/stripe",e);case 2:a=t.sent,n({type:"fetch_user",payload:a.data});case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},I=function(e,t){return function(){var n=Object(N.a)(O.a.mark(function n(a){var r;return O.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,_.a.post("/api/surveys",e);case 2:r=n.sent,t.push("/surveys"),a({type:"fetch_user",payload:r.data});case 5:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()},A=function(){return function(){var e=Object(N.a)(O.a.mark(function e(t){var n;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.a.get("/api/surveys");case 2:n=e.sent,t({type:"fetch_surveys",payload:n.data});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},V=function(e){return e.sort(function(e,t){return S(e.dateSent)-S(t.dateSent)}),{type:"fetch_surveys",payload:e}},L=function(e){return e.sort(function(e,t){return-(S(e.dateSent)-S(t.dateSent))}),{type:"fetch_surveys",payload:e}},Y=function(e){return e.sort(function(e,t){return e.yes-t.yes}),{type:"fetch_surveys",payload:e}},R=function(e){return function(){var t=Object(N.a)(O.a.mark(function t(n){var a;return O.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.a.post("/api/surveys/delete",{id:e});case 2:a=t.sent,n({type:"fetch_surveys",payload:a.data});case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},T=function(e){return function(){var t=Object(N.a)(O.a.mark(function t(n){var a,r;return O.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=7;break}return t.next=3,_.a.get("/api/surveys/draft");case 3:a=t.sent,n({type:x,payload:a.data}),t.next=11;break;case 7:return t.next=9,_.a.post("/api/surveys/draft",e);case 9:r=t.sent,n({type:x,payload:r.data});case 11:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},W=function(e){return function(){var t=Object(N.a)(O.a.mark(function t(n){return O.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.clear&&n({type:x,payload:{}}),!e.delete){t.next=5;break}return t.next=4,_.a.post("/api/surveys/draft/delete",{});case 4:n({type:x,payload:{}});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},G=function(e){function t(){return Object(p.a)(this,t),Object(f.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return c.a.createElement(g.a,{name:"Emaily",description:"5$ for 5 emails use card 4242 4242 4242 4242",amount:500,token:function(t){return e.props.handleToken(t)},stripeKey:"pk_test_fj0Fh1kxVNIXo8KVnx0GFRGv"},c.a.createElement("div",{className:this.props.btnClass},"Add Credits"))}}]),t}(r.Component),B=Object(u.b)(null,a)(G),U=function(e){function t(){var e,n;Object(p.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(f.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).logout=function(){n.props.logout(n.props.history)},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentWillMount",value:function(){this.props.fetchUser(this.props.history)}},{key:"renderContent",value:function(){switch(this.props.auth){case null:return;case!1:return c.a.createElement("li",null,c.a.createElement("a",{href:"/auth/google"},"Login With Google"));default:return[c.a.createElement("li",{key:"1"},c.a.createElement(B,{btnClass:"custom-btn custom-btn--green custom-inline"})),c.a.createElement("li",{key:"3",style:{margin:"0 10px"}},"  Credits: ",this.props.auth.credits," "),c.a.createElement("li",{key:"2"},c.a.createElement("a",{onClick:this.logout,href:"#!"},"Logout"))]}}},{key:"renderDropContent",value:function(){switch(this.props.auth){case null:return;case!1:return c.a.createElement(b.NavItem,{href:"/auth/google"},"Login With Google");default:return[c.a.createElement(b.NavItem,{key:"1",onClick:function(){}},c.a.createElement(B,{btnClass:""})),c.a.createElement(b.NavItem,{key:"3",onClick:function(){}},"Credits: ",this.props.auth.credits," "),c.a.createElement(b.NavItem,{key:"4",divider:!0}),c.a.createElement(b.NavItem,{key:"2",onClick:this.logout},"Logout")]}}},{key:"render",value:function(){return c.a.createElement("div",null,c.a.createElement("nav",{className:"nav-wrapper deep-orange accent-4"},c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"nav-wrapper "},c.a.createElement(y.b,{style:{margin:"0 10px"},to:this.props.auth?"/surveys":"/",className:"left brand-logo"},"Emaily"),c.a.createElement("div",{className:"right hide-on-med-and-up",style:{margin:"0 20px"}},c.a.createElement(b.Dropdown,{options:{hover:!0},trigger:c.a.createElement("a",{href:"#!",type:"text"},c.a.createElement("i",{className:"material-icons"},"menu"))},this.renderDropContent())),c.a.createElement("ul",{id:"nav-mobile",className:"right hide-on-small-and-down"},this.renderContent())))))}}]),t}(r.Component);var z=Object(u.b)(function(e){return{auth:e.auth}},a)(Object(y.d)(U)),Z=function(e){function t(){return Object(p.a)(this,t),Object(f.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderContent",value:function(){switch(this.props.auth){case null:return;case!1:return c.a.createElement("div",null,c.a.createElement("h3",null,"Emaily"),c.a.createElement("h6",{className:"custom-line"},"Fast and easy way to collect feedback from your clients"),c.a.createElement("h6",{className:"custom-line"},"Login to start sending surveyes"),c.a.createElement("a",{className:"custom-btn  custom-btn--grey  custom-my-20 ",href:"/auth/google"},"Login With Google"));default:return c.a.createElement("div",null,c.a.createElement("h5",{className:"custom-mt-20"}," Welcome to Emaily! "),c.a.createElement("h6",{className:"custom-mt-10 custom-line"},"You are now ready to start collecting feedbacks "),c.a.createElement(y.b,{className:"custom-btn  custom-btn--grey custom-my-20 ",to:this.props.auth?"/surveys":"/"},"Next step \u2192"))}}},{key:"render",value:function(){return c.a.createElement("div",{className:"custom-landing_card"},this.renderContent())}}]),t}(r.Component);var $=Object(u.b)(function(e){return{auth:e.auth}})(Z),q=function(e){function t(){return Object(p.a)(this,t),Object(f.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"deleteSurvey",value:function(){this.props.deleteSurvey(arguments[0])}},{key:"render",value:function(){var e=this.props.survey;return c.a.createElement("div",{className:"custom-card"},c.a.createElement("div",{className:"custom-card__content"},c.a.createElement("div",{className:"custom-card__content-title"},c.a.createElement("div",{className:"custom-card__content-left"},"Title:"),c.a.createElement("div",{className:"custom-card__content-right custom-text-2"},e.title)),c.a.createElement("div",{className:"custom-card__content-qtn"},c.a.createElement("div",{className:"custom-card__content-left"},"Question:"),c.a.createElement("div",{className:"custom-card__content-right custom-text"},e.body)),c.a.createElement("div",{className:"custom-card__content-subject"},c.a.createElement("div",{className:"custom-card__content-left"},"Subject:"),c.a.createElement("div",{className:"custom-card__content-right"},e.subject)),c.a.createElement("div",{className:"custom-card__content-subject"},c.a.createElement("div",{className:"custom-card__content-left"},"Date sent:"),c.a.createElement("div",{className:"custom-card__content-right"},new Date(e.dateSent).toLocaleDateString()))),c.a.createElement("div",{className:"custom-card__action"},c.a.createElement("div",{className:"custom-card__action-left"},c.a.createElement("div",{className:"custom-card__action-votes"},"YES: ",e.yes),c.a.createElement("div",{className:"custom-card__action-votes"},"NO: ",e.no)),c.a.createElement("button",{className:"custom-card__action-right custom-btn custom-btn--orange-2",onClick:this.deleteSurvey.bind(this,e._id)},"Delete Survey")))}}]),t}(r.Component),H=Object(u.b)(null,a)(q),J=function(e){function t(){return Object(p.a)(this,t),Object(f.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderDropdownItems",value:function(){if(this.props.items)return this.props.items.map(function(e,t){return c.a.createElement("button",{className:"dropdown__content-item",key:t,type:"button",onClick:e.fn},e.text)})}},{key:"render",value:function(){var e=this.props.placeholder;return c.a.createElement("div",{className:"dropdown"},c.a.createElement("div",{className:"dropdown__content"},this.renderDropdownItems()),c.a.createElement("div",{className:"dropdown__btn dropdown__grey"},e))}}]),t}(r.Component),K=function(e){function t(){var e,n;Object(p.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(f.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).sortAscSurveys=function(){var e=n.props.surveys.slice();n.props.sortAscSurveys(e)},n.sortDescSurveys=function(){var e=n.props.surveys.slice();n.props.sortDescSurveys(e)},n.sortYesSurveys=function(){var e=n.props.surveys.slice();n.props.sortYesSurveys(e)},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchSurveys()}},{key:"renderSurveyNav",value:function(){var e=[{text:"Date Sent Asc",fn:this.sortAscSurveys},{text:"Date Sent Desc",fn:this.sortDescSurveys},{text:"Yes Response",fn:this.sortYesSurveys}];return this.props.surveys.length?c.a.createElement("div",null,c.a.createElement("div",{className:"custom-group-buttons custom-mt-15"},c.a.createElement("div",null,c.a.createElement("h5",{className:" grey-text text-darken-1 custom-margin-none"},"Active surveys")),c.a.createElement("div",{style:{flex:"1"}}," "),c.a.createElement(y.b,{to:"/surveys/new",className:"custom-btn custom-btn--grey-1"},"New survey"),c.a.createElement(J,{items:e,placeholder:"Sort by"})),c.a.createElement("div",{style:{margin:"20px 0"}},c.a.createElement("hr",null))):c.a.createElement("div",{className:"custom-landing_card"},c.a.createElement("h5",{className:"custom-text custom-mt-20"},"You currently do not have any surveys"),c.a.createElement(y.b,{className:"custom-btn custom-btn--grey custom-my-20 ",to:"/surveys/new"},"Create survey \u2192"))}},{key:"renderSurveys",value:function(){return this.props.surveys.reverse().map(function(e){return c.a.createElement(H,{key:e._id,survey:e})})}},{key:"render",value:function(){var e=this.props.surveys.length;return c.a.createElement("div",{className:"custom-pos-relative custom-pt-20"},c.a.createElement("div",{className:e?"custom-survey_card":"custom-pos-relative custom-mt-100"},this.renderSurveyNav(),this.renderSurveys()))}}]),t}(r.Component);var M=Object(u.b)(function(e){return{surveys:e.surveys}},a)(K),P=function(e){function t(){return Object(p.a)(this,t),Object(f.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderContent",value:function(){switch(this.props.auth){case null:case!1:return;default:return c.a.createElement("div",null,c.a.createElement(M,null),c.a.createElement("div",{className:"fixed-action-btn"},c.a.createElement(y.b,{to:"/surveys/new",className:"btn-floating btn-large red"},c.a.createElement("i",{className:" material-icons"},"add"))))}}},{key:"render",value:function(){return c.a.createElement("div",null,this.renderContent())}}]),t}(r.Component);var Q=Object(u.b)(function(e){return{auth:e.auth}})(P),X=n(182),ee=n(56),te=n.n(ee),ne=n(183),ae=function(e){var t=e.input,n=e.label,a=e.placeHolder,r=e.meta,s=r.error,o=r.touched;return c.a.createElement("div",null,c.a.createElement("label",null,n),c.a.createElement("input",Object.assign({},t,{style:{marginBottom:"5px"},placeholder:a})),c.a.createElement("div",{className:"red-text",style:{marginBottom:"20px"}},o&&s))},re=/^[a-zA-Z0-9.!#$%&\u2019*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,ce=function(e,t){var n=e.split(",").map(function(e){return e.trim()}).filter(function(e){return!1===re.test(e)});return""===n[n.length-1]&&n.pop(),n.length&&"from"!==t?"These emails are invalid: ".concat(n):n.length&&"from"===t?"This email is invalid: ".concat(n):void 0},se=[{label:"Survey Title",name:"title"},{label:"Subject Line",name:"subject"},{label:"Email Body",name:"body"},{label:"Recipient List",name:"recipients"},{label:"From",name:"from"}],oe=function(e){function t(){return Object(p.a)(this,t),Object(f.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"saveDraft",value:function(){if(this.props.formValues){var e=this.props.formValues,t={title:e.title,subject:e.subject,body:e.body,recipients:e.recipients,from:e.from};this.props.fetchDraft(t)}}},{key:"renderFields",value:function(){return te.a.map(se,function(e){var t=e.label,n=e.name,a="";return"from"===n&&(a="Leave blank for no-reply@emaily.com or enter your email"),c.a.createElement(ne.a,{key:n,label:t,type:"text",name:n,placeHolder:a,component:ae})})}},{key:"render",value:function(){return c.a.createElement("div",null,c.a.createElement("form",{onSubmit:this.props.handleSubmit(this.props.onSurveySubmit)},this.renderFields(),c.a.createElement("div",{className:"custom-group-buttons custom-mt-30 custom-mb-20"},c.a.createElement(y.b,{to:"/surveys",className:"custom-btn custom-btn--red custom-align-center"},"Cancel"),c.a.createElement("button",{className:"custom-btn custom-btn--green-2 custom-align-center",onClick:this.saveDraft.bind(this)},c.a.createElement("span",null,"Save Draft"),c.a.createElement("i",{className:"material-icons right custom-icon"},"backup")),c.a.createElement("button",{type:"submit",className:"custom-btn custom-btn--green-2 "},"Next \u2192"))))}}]),t}(r.Component);oe=Object(X.a)({validate:function(e){var t={};return t.recipients=ce(e.recipients||""),te.a.each(se,function(n){var a=n.name;e[a]||"from"===a||(t[a]="You must provide ".concat(a)),e[a]&&"from"===a&&(t[a]=ce(e[a],a))}),t},form:"surveyForm",destroyOnUnmount:!1})(oe);var ue=oe=Object(u.b)(function(e){return e.form.surveyForm?{initialValues:e.formInit,formValues:e.form.surveyForm.values}:{initialValues:e.formInit}},{fetchDraft:T})(oe);var ie=Object(u.b)(function(e){return{formValues:e.form.surveyForm.values,credits:e.auth.credits}},a)(Object(y.d)(function(e){var t=e.onCancel,n=e.formValues,a=e.submitSurvey,r=e.clearDraft,s=e.history,o=e.credits,u=te.a.map(se,function(e){var t=e.name,a=e.label;return c.a.createElement("div",{key:t},c.a.createElement("label",null,a),c.a.createElement("div",null,"from"!==t?n[t]:n[t]?n[t]:"no-reply@emaily.com"))}),i=function(){var e=Object(N.a)(O.a.mark(function e(){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o>0)){e.next=6;break}return e.next=3,a(n,s);case 3:r({delete:!0}),e.next=7;break;case 6:window.alert("You need credits");case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();return c.a.createElement("div",null,c.a.createElement("h5",null,"Please confirm your entries"),c.a.createElement("div",null,u),c.a.createElement("div",{className:"custom-mt-30 custom-mb-20 custom-group-buttons"},c.a.createElement("button",{className:" custom-btn  custom-btn--orange",onClick:t}," \u2190 Back"),function(){if(0===o)return c.a.createElement("div",{className:"custom-alarm-text"},"You have 0 credits left!")}(),c.a.createElement("button",{disabled:0===o,className:" custom-btn custom-btn--green-2 custom-align-center",onClick:i},c.a.createElement("span",null,"Send Survey"),c.a.createElement("i",{className:"material-icons right custom-icon"},"email"))))})),le=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(f.a)(this,Object(v.a)(t).call(this,e))).state={showFormReview:!1},n.props.fetchDraft(),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentWillUnmount",value:function(){this.props.clearDraft({clear:!0})}},{key:"renderContent",value:function(){var e=this;return this.props.DraftValues._id||this.props.DraftValues.noDraft?this.state.showFormReview?c.a.createElement(ie,{onCancel:function(){return e.setState({showFormReview:!1})}}):c.a.createElement(ue,{onSurveySubmit:function(){return e.setState({showFormReview:!0})}}):c.a.createElement("div",null,"Loading...")}},{key:"render",value:function(){return c.a.createElement("div",{className:"custom-pos-relative custom-pt-20"},c.a.createElement("div",{className:"custom-survey_card"},this.renderContent()))}}]),t}(r.Component);le=Object(X.a)({form:"surveyForm"})(le);var me=le=Object(u.b)(function(e){return{DraftValues:e.formInit}},{fetchDraft:T,clearDraft:W})(le),pe=function(e){function t(){return Object(p.a)(this,t),Object(f.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return c.a.createElement(y.a,null,c.a.createElement("div",null,c.a.createElement(z,null),c.a.createElement("div",{className:"custom-image"},c.a.createElement("div",{className:"container"},c.a.createElement(y.c,{exact:!0,path:"/",component:$}),c.a.createElement(y.c,{exact:!0,path:"/surveys",component:Q}),c.a.createElement(y.c,{path:"/surveys/new",component:me})))))}}]),t}(r.Component),de=n(184);var fe=Object(i.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"fetch_user":return t.payload||!1;default:return e}},form:de.a,surveys:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"fetch_surveys":return t.payload;default:return e}},draft:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return t.payload;default:return e}},formInit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return t.payload;default:return e}}}),ve=Object(i.d)(fe,{},Object(i.a)(m.a));o.a.render(c.a.createElement(u.a,{store:ve},c.a.createElement(pe,null)),document.querySelector("#root"))}},[[105,2,1]]]);
//# sourceMappingURL=main.7d8f112f.chunk.js.map